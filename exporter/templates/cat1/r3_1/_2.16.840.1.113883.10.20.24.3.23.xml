<entry>
  <encounter classCode="ENC" moodCode="EVN">
    <!-- Encounter activities template -->
    <templateId root="2.16.840.1.113883.10.20.22.4.49" extension="2014-06-09" />
    <!-- Encounter performed template -->
    <templateId root="2.16.840.1.113883.10.20.24.3.23" extension="2014-12-01" />
    <id root="1.3.6.1.4.1.115" extension="{{newRandom}}"/>
    {{/*$extraContent := "sdtc:valueSet=\"#{value_set_oid}\""*/}}

    {{template "_code.xml" codeDisplayWithPreferredCode .EntrySection.Entry .EntrySection.Entry.Coded .MapDataCriteria "entryCode"}}
    <text>{{.EntrySection.Description}}</text>
    <statusCode code="completed"/>
    <effectiveTime>
      <!-- We try to look for the admit/discharge times on the encounter if they are there. If not, we fall back to the typical start/end date. -->
      {{$startTime := condAssign .EntrySection.AdmitTime .EntrySection.StartTime}}
      {{$endTime := condAssign .EntrySection.DischargeTime .EntrySection.EndTime}}
      <low {{valueOrNullFlavor $startTime}}/>
      <high {{valueOrNullFlavor $endTime}}/>
    </effectiveTime>
    {{if .EntrySection.DischargeDisposition}}
      {{dischargeDispositionDisplay .EntrySection.DischargeDisposition}}
    {{end}}

    {{/* - - - facility code goes here - - - */}}

    {{if .EntrySection.Reason}}
      {{template "_reason.xml" .}}
    {{end}}
  </encounter>
</entry>
